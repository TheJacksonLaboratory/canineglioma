{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Comparative molecular life history of spontaneous canine and human gliomas \u00b6 Preprint \u00b6 Comparative molecular life history of spontaneous canine and human gliomas Samirkumar B. Amin, Kevin J. Anderson, C. Elizabeth Boudreau, Emmanuel Martinez-Ledesma, Emre Kocakavuk, Kevin C. Johnson, Floris P. Barthel, Frederick S. Varn, Cynthia Kassab, Xiaoyang Ling, Hoon Kim, Mary Barter, Ching C. Lau, Chew Yee Ngan, Margaret Chapman, Jennifer W. Koehler, James P. Long, Andrew D. Miller, C. Ryan Miller, Brian F. Porter, Daniel R. Rissi, Christina Mazcko, Amy K. LeBlanc, Peter J. Dickinson, Rebecca A. Packer, Amanda R. Taylor, John H. Rossmeisl Jr, Kevin D. Woolard, Amy B. Heimberger, Jonathan M. Levine2, Roel G. W. Verhaak bioRxiv 673822; doi: https://doi.org/10.1101/673822 Work under peer review Summary Sporadic gliomas in companion dogs provide a window on the interaction between tumorigenic mechanisms and host environment. We compared the molecular profiles of canine gliomas with those of human pediatric and adult gliomas to characterize evolutionarily conserved mammalian mutational processes in gliomagenesis. Employing whole genome-, exome-, transcriptome- and methylation-sequencing of 83 canine gliomas, we found alterations shared between canine and human gliomas such as the receptor tyrosine kinases, TP53 and cell cycle pathways, and IDH1 R132. Canine gliomas showed high similarity with human pediatric gliomas per robust aneuploidy, mutational rates, relative timing of mutations, and DNA methylation patterns. Our cross-species comparative genomic analysis provides unique insights into glioma etiology and the chronology of glioma-causing somatic alterations. Significance Diffuse gliomas are the most common malignant brain tumors, with high-grade tumors carrying a dismal prognosis. Preclinical models have proven themselves as poor predictors of clinical efficacy. Spontaneous glioma in dogs provides an attractive alternative model, because of their comparable tumor microenvironment and tumor life history. We determined the similarities and differences between human and canine gliomas through genomic profiling, and leveraged our datasets to identify conserved somatic drivers, mutational processes and temporal ordering of somatic glioma events across species. We show that canine gliomas resemble human gliomas at (epi-)genetic levels and are more reminiscent of pediatric than adult disease, thus rationalizing sporadic canine glioma as a preclinical model tailored to measuring treatment efficacies in patients with canine or human glioma. // Set the date we're counting down to var countDownDate = new Date(\"Jun 17, 2019 14:46:00\").getTime(); // Set the date of receiving response to first review var countDownDate_1strev = new Date(\"Jul 23, 2019 14:00:00\").getTime(); // Set the date of sending response to first review var countDownDate_1strevsent = new Date(\"Nov 15, 2019 15:00:00\").getTime(); // Get today's date and time var now = new Date().getTime(); // Find the distance between now and the count down date var distance = now - countDownDate; var distance_1strev = now - countDownDate_1strev; var distance_1strevsent = now - countDownDate_1strevsent; // Time calculations for days, hours, minutes and seconds var days = Math.floor(distance / (1000 * 60 * 60 * 24)); var days_1strev = Math.floor(distance_1strev / (1000 * 60 * 60 * 24)); var days_1strevsent = Math.floor(distance_1strevsent / (1000 * 60 * 60 * 24)); // Output the result in an element with id=\"demo\" document.getElementById(\"demo\").innerHTML = days + \" days since the initial submission.\"; document.getElementById(\"demo_1strev\").innerHTML = days_1strev + \" days since the first editorial response.\"; document.getElementById(\"demo_1strevsent\").innerHTML = days_1strevsent + \" days since resubmission.\"; // If the count down is over, write some text if (distance_1strev < 0) { document.getElementById(\"demo_1strev\").innerHTML = \"Work under peer-review: Timer expired.\"; }","title":"Home"},{"location":"#comparative-molecular-life-history-of-spontaneous-canine-and-human-gliomas","text":"","title":"Comparative molecular life history of spontaneous canine and human gliomas"},{"location":"#preprint","text":"Comparative molecular life history of spontaneous canine and human gliomas Samirkumar B. Amin, Kevin J. Anderson, C. Elizabeth Boudreau, Emmanuel Martinez-Ledesma, Emre Kocakavuk, Kevin C. Johnson, Floris P. Barthel, Frederick S. Varn, Cynthia Kassab, Xiaoyang Ling, Hoon Kim, Mary Barter, Ching C. Lau, Chew Yee Ngan, Margaret Chapman, Jennifer W. Koehler, James P. Long, Andrew D. Miller, C. Ryan Miller, Brian F. Porter, Daniel R. Rissi, Christina Mazcko, Amy K. LeBlanc, Peter J. Dickinson, Rebecca A. Packer, Amanda R. Taylor, John H. Rossmeisl Jr, Kevin D. Woolard, Amy B. Heimberger, Jonathan M. Levine2, Roel G. W. Verhaak bioRxiv 673822; doi: https://doi.org/10.1101/673822 Work under peer review Summary Sporadic gliomas in companion dogs provide a window on the interaction between tumorigenic mechanisms and host environment. We compared the molecular profiles of canine gliomas with those of human pediatric and adult gliomas to characterize evolutionarily conserved mammalian mutational processes in gliomagenesis. Employing whole genome-, exome-, transcriptome- and methylation-sequencing of 83 canine gliomas, we found alterations shared between canine and human gliomas such as the receptor tyrosine kinases, TP53 and cell cycle pathways, and IDH1 R132. Canine gliomas showed high similarity with human pediatric gliomas per robust aneuploidy, mutational rates, relative timing of mutations, and DNA methylation patterns. Our cross-species comparative genomic analysis provides unique insights into glioma etiology and the chronology of glioma-causing somatic alterations. Significance Diffuse gliomas are the most common malignant brain tumors, with high-grade tumors carrying a dismal prognosis. Preclinical models have proven themselves as poor predictors of clinical efficacy. Spontaneous glioma in dogs provides an attractive alternative model, because of their comparable tumor microenvironment and tumor life history. We determined the similarities and differences between human and canine gliomas through genomic profiling, and leveraged our datasets to identify conserved somatic drivers, mutational processes and temporal ordering of somatic glioma events across species. We show that canine gliomas resemble human gliomas at (epi-)genetic levels and are more reminiscent of pediatric than adult disease, thus rationalizing sporadic canine glioma as a preclinical model tailored to measuring treatment efficacies in patients with canine or human glioma. // Set the date we're counting down to var countDownDate = new Date(\"Jun 17, 2019 14:46:00\").getTime(); // Set the date of receiving response to first review var countDownDate_1strev = new Date(\"Jul 23, 2019 14:00:00\").getTime(); // Set the date of sending response to first review var countDownDate_1strevsent = new Date(\"Nov 15, 2019 15:00:00\").getTime(); // Get today's date and time var now = new Date().getTime(); // Find the distance between now and the count down date var distance = now - countDownDate; var distance_1strev = now - countDownDate_1strev; var distance_1strevsent = now - countDownDate_1strevsent; // Time calculations for days, hours, minutes and seconds var days = Math.floor(distance / (1000 * 60 * 60 * 24)); var days_1strev = Math.floor(distance_1strev / (1000 * 60 * 60 * 24)); var days_1strevsent = Math.floor(distance_1strevsent / (1000 * 60 * 60 * 24)); // Output the result in an element with id=\"demo\" document.getElementById(\"demo\").innerHTML = days + \" days since the initial submission.\"; document.getElementById(\"demo_1strev\").innerHTML = days_1strev + \" days since the first editorial response.\"; document.getElementById(\"demo_1strevsent\").innerHTML = days_1strevsent + \" days since resubmission.\"; // If the count down is over, write some text if (distance_1strev < 0) { document.getElementById(\"demo_1strev\").innerHTML = \"Work under peer-review: Timer expired.\"; }","title":"Preprint"},{"location":"methods/","text":"Methods \u00b6 Published data sources Sample preparation, Quality controls (QC) and Sequencing strategies Sequencing alignments, QC, and fingerprinting Somatic variant calling Significantly mutated genes analysis Cancer hallmark analysis Quantifying somatic mutation rates Somatic copy number segmentation and GISTIC2 based significance Allele specific copy-number analysis Aneuploidy metrics Syntenic regions and clustering based on aneuploidy metrics Estimating intra-tumoral heterogeneity Mutational signatures analysis Molecular timing analysis and natural history of tumors Class prediction using methylation data CIBERSORT based expression analysis to study tumor microenvironment Immunehistochemistry (IHC) Scanning and tissue segmentation of IHC slides","title":"Home"},{"location":"methods/#methods","text":"Published data sources Sample preparation, Quality controls (QC) and Sequencing strategies Sequencing alignments, QC, and fingerprinting Somatic variant calling Significantly mutated genes analysis Cancer hallmark analysis Quantifying somatic mutation rates Somatic copy number segmentation and GISTIC2 based significance Allele specific copy-number analysis Aneuploidy metrics Syntenic regions and clustering based on aneuploidy metrics Estimating intra-tumoral heterogeneity Mutational signatures analysis Molecular timing analysis and natural history of tumors Class prediction using methylation data CIBERSORT based expression analysis to study tumor microenvironment Immunehistochemistry (IHC) Scanning and tissue segmentation of IHC slides","title":"Methods"},{"location":"methods/S01_samples/","text":"Tissue samples from canine patients with gliomas were acquired with material transfer agreements from Auburn University College of Veterinary Medicine, Colorado State University, Texas A&M College of Veterinary Medicine & Biomedical Sciences, UC Davis School of Veterinary Medicine and Virginia-MD College of Veterinary Medicine. Tissue samples from resected tumor (n=83) and matched normal tissue (n=67 or paired cases) were collected at the surgical treatment or immediately following euthanasia. There were also four additional dog patients where we had adequate DNA and RNA for methylation (n=48) and RNA-seq (n=40) profiling but unable to do WGS/Exome sequencing because of failed library preparation (see Table S1). Matched normal tissue were from post-necropsy sample of contra-lateral healthy brain tissue (n=38), white blood cells (n=13), and remaining 17 samples from other tissues. Samples were archived in snap-frozen (n=37/67 paired cases; n=8/16 tumor-only cases) and Formalin-Fixed Paraffin-Embedded (FFPE, n=30/67 paired cases; n=8/16 tumor-only cases) state. Samples were then shipped to sequencing core facilities for sample preparation, quality control and sequencing (see Methods below).","title":"Samples"},{"location":"methods/S02_data_sources/","text":"For comparison to human glioma, we downloaded both - raw sequencing data and processed tables for human pediatric and adult gliomas with appropriate controlled-data access agreements where needed. We used published mutation rates (Figure 1D) and mutational signatures (Figure 3) from pan-cancer datasets from adults (n=3,281) and pediatric (n=961) cohorts (Alexandrov et al., 2013; Bailey et al., 2018; Gr\u00f6bner et al., 2018). For aneuploidy and molecular life history analysis (details below), we downloaded raw sequencing data and analyzed whole genomes from 53 pediatric gliomas (Ma et al., 2018; St. Jude Cloud Pediatric Cancer Genome Project, https://pecan.stjude.cloud ), SNP6 data from adult gliomas \u2013 IDHwt (n=517), IDHmut-codel (n=171), and IDHmut-noncodel (n=281) cases (Ceccarelli et al., 2016), as well as whole genomes from 23 adult GBMs (Brennan et al., 2013). For coding mutation rate calculation, we used a subset of TCGA glioma set where exome/whole genome based variant calls were available: IDHwt (n=371), IDHmut-non-codel (n=268), and IDHmut-codel (n=169).","title":"Data Sources"},{"location":"methods/S03_sample_prep/","text":"DNA/RNA extraction \u00b6 Genomic DNA and total RNA of fresh frozen tissue and FFPE tissue from paraffin scrolls were were extracted simultaneously using AllPrep DNA/RNA Mini Kit (Qiagen) and AllPrep DNA/RNA FFPE Kit (Qiagen) according to the manufacturer\u2019s instructions, respectively. Additional DNase treatment was performed on-column for RNA purification. Whole-Genome Sequencing \u00b6 200-400ng of DNA was sheared to 400bp using a LE220 focused-ultrasonicator (Covaris) and size selected using Ampure XP beads (Beckman Coulter). The fragments were treated with end-repair, A-tailing, and ligation of Illumina compatible adapters (Integrated DNA Technologies) using the KAPA Hyper Prep Kit (Illumina) (KAPA Biosystems/ Roche). For FFPE samples, 5 to 10 cycles of PCR amplification were performed. Quantification of libraries were performed using real-time qPCR (Thermo Fisher). Libraries were sequenced paired end reads of 151bp on Illumina Hiseq X-Ten (Novogene). Exome Sequencing \u00b6 Sample were prepared as described above in the WGS sample preparation, targeting 200bp with PCR amplification. Target capture was performed using SeqCap EZ Canine Exome Custom Design (canine 140702_canFam3_exomeplus_BB_EZ_HX1 probe set) (Broeckx et al., 2015) (Roche Nimblegen). Briefly, WGS libraries were hybridized with capture probes using Nimblegen SepCap EZ Kit (Roche Nimblegen) according to manufacturer\u2019s instruction. Captured fragments were PCR amplified and purified using Ampure XP beads. Quantification of libraries were performed using real-time qPCR (Thermo Fisher). Libraries were sequenced paired end of 76bp on Hiseq4000 (Illumina). RNA-seq \u00b6 RNA-seq libraries were prepared with KAPA Stranded mRNA-Seq kit (Kapa Biosystem/ Roche) according to manufacturer\u2019s instruction. First, poly A RNA was isolated from 300ng total RNA using oligo-dT magnetic beads. Purified RNA was then fragmented at 85\u00b0C for 6 mins, targeting fragments range 250-300bp. Fragmented RNA is reverse-transcribed with an incubation of 25\u00b0C for 10mins, 42\u00b0C for 15 mins and an inactivation step at 70\u00b0C for 15mins. This was followed by second strand synthesis at 16\u00b0C, 60 mins. Double stranded cDNA (dscDNA) fragments were purified using Ampure XP beads (Beckman). The dscDNA were then A-tailed, and ligated with illumina compatible adaptors (IDT). Adaptor-ligated DNA was purified using Ampure XP beads. This is followed by 10 cycles of PCR amplification. The final library was cleaned up using AMpure XP beads. Quantification of libraries were performed using real-time qPCR (Thermo Fisher). Sequencing was performed on Hiseq4000 (Illumina) generating paired end reads of 75bp. Reduced Representation Bisulfite Sequencing (RRBS) \u00b6 Library preparation for RRBS was performed using Premium RRBS Kit (Diagenode) according to manufacturer\u2019s instructions. Briefly, 100ng of DNA was used for each sample, which was enzymatically digested, end-repaired and ligated with an adaptor. Subsequently, 8 samples with different adaptors were pooled together and subjected to bisulfite treatment. After purification steps following bisulfite conversion, the pooled DNA was amplified with 9-14 cycles of PCR and then cleaned up with Ampure XP beads. Quantification of libraries were performed using real-time qPCR (Thermo Fisher). Libraries were sequenced single end 101bp on Hiseq2500 (Illumina).","title":"Sample Preparations"},{"location":"methods/S03_sample_prep/#dnarna-extraction","text":"Genomic DNA and total RNA of fresh frozen tissue and FFPE tissue from paraffin scrolls were were extracted simultaneously using AllPrep DNA/RNA Mini Kit (Qiagen) and AllPrep DNA/RNA FFPE Kit (Qiagen) according to the manufacturer\u2019s instructions, respectively. Additional DNase treatment was performed on-column for RNA purification.","title":"DNA/RNA extraction"},{"location":"methods/S03_sample_prep/#whole-genome-sequencing","text":"200-400ng of DNA was sheared to 400bp using a LE220 focused-ultrasonicator (Covaris) and size selected using Ampure XP beads (Beckman Coulter). The fragments were treated with end-repair, A-tailing, and ligation of Illumina compatible adapters (Integrated DNA Technologies) using the KAPA Hyper Prep Kit (Illumina) (KAPA Biosystems/ Roche). For FFPE samples, 5 to 10 cycles of PCR amplification were performed. Quantification of libraries were performed using real-time qPCR (Thermo Fisher). Libraries were sequenced paired end reads of 151bp on Illumina Hiseq X-Ten (Novogene).","title":"Whole-Genome Sequencing"},{"location":"methods/S03_sample_prep/#exome-sequencing","text":"Sample were prepared as described above in the WGS sample preparation, targeting 200bp with PCR amplification. Target capture was performed using SeqCap EZ Canine Exome Custom Design (canine 140702_canFam3_exomeplus_BB_EZ_HX1 probe set) (Broeckx et al., 2015) (Roche Nimblegen). Briefly, WGS libraries were hybridized with capture probes using Nimblegen SepCap EZ Kit (Roche Nimblegen) according to manufacturer\u2019s instruction. Captured fragments were PCR amplified and purified using Ampure XP beads. Quantification of libraries were performed using real-time qPCR (Thermo Fisher). Libraries were sequenced paired end of 76bp on Hiseq4000 (Illumina).","title":"Exome Sequencing"},{"location":"methods/S03_sample_prep/#rna-seq","text":"RNA-seq libraries were prepared with KAPA Stranded mRNA-Seq kit (Kapa Biosystem/ Roche) according to manufacturer\u2019s instruction. First, poly A RNA was isolated from 300ng total RNA using oligo-dT magnetic beads. Purified RNA was then fragmented at 85\u00b0C for 6 mins, targeting fragments range 250-300bp. Fragmented RNA is reverse-transcribed with an incubation of 25\u00b0C for 10mins, 42\u00b0C for 15 mins and an inactivation step at 70\u00b0C for 15mins. This was followed by second strand synthesis at 16\u00b0C, 60 mins. Double stranded cDNA (dscDNA) fragments were purified using Ampure XP beads (Beckman). The dscDNA were then A-tailed, and ligated with illumina compatible adaptors (IDT). Adaptor-ligated DNA was purified using Ampure XP beads. This is followed by 10 cycles of PCR amplification. The final library was cleaned up using AMpure XP beads. Quantification of libraries were performed using real-time qPCR (Thermo Fisher). Sequencing was performed on Hiseq4000 (Illumina) generating paired end reads of 75bp.","title":"RNA-seq"},{"location":"methods/S03_sample_prep/#reduced-representation-bisulfite-sequencing-rrbs","text":"Library preparation for RRBS was performed using Premium RRBS Kit (Diagenode) according to manufacturer\u2019s instructions. Briefly, 100ng of DNA was used for each sample, which was enzymatically digested, end-repaired and ligated with an adaptor. Subsequently, 8 samples with different adaptors were pooled together and subjected to bisulfite treatment. After purification steps following bisulfite conversion, the pooled DNA was amplified with 9-14 cycles of PCR and then cleaned up with Ampure XP beads. Quantification of libraries were performed using real-time qPCR (Thermo Fisher). Libraries were sequenced single end 101bp on Hiseq2500 (Illumina).","title":"Reduced Representation Bisulfite Sequencing (RRBS)"},{"location":"methods/S04_alignments_fprint/","text":"DNA alignments \u00b6 DNA alignments for whole genome (WGS) and exome sequencing was done using bwa-mem (version 0.7.15-r1140) (Fleshner and Chernett, 1997) with -M -t 12 argument and against CanFam3.1 reference genome from UCSC, https://genome.ucsc.edu/cgi-bin/hgGateway?db=canFam3 (md5: 112bc809596d22c896d7e9bcbe68ede6). For each sample, fastq files were aligned per read group and then merged using Picard tools (v2.18.0, http://broadinstitute.github.io/picard ) SortSam command to make an interim bam file. Final, analysis-ready bam file per sample \u2013 tumor and normal bam, if available \u2013 was created by series of steps following best practices guidelines from GATK4 (version 4.0.8.1) (DePristo et al., 2011), namely MarkDuplicates, Indel Realignment, and Base Quality Score Recalibration (BQSR). Alignment QC metrics were calculated using GATK4 DepthOfCoverage (for WGS) and CollectHSMetrics (for exome) as well as Qualimap (version 2.2.1) (Okonechnikov et al., 2016) bamqc for merged bam files. Coverage statistics were also based on regions of interest (ROIs) which consisted of exonic region-level annotations for biotypes: protein-coding gene, microrna, lincrna, and pseudogene from Ensembl gene annotations for canine genome (v91 and higher). We flagged samples as failed QC if merged bam file has a genome-wide coverage of < 30% or > 75% of ROIs have 30% or lesser coverage. Accordingly, three samples (of three cases) failed QC step and they were removed from all analyses. Note that 77 cases in patient tissues and samples section represent all cases which passed QC at WGS, exome, RNA-seq, and methylation level data preprocessing. RNA alignments \u00b6 Raw fastq files from paired-end RNA-seq assay for 41 tumor samples and 3 matched normal tissue samples were first preprocessed through fastp (version 0.19.5) (Chen et al., 2018) to perform read-based quality pruning, including adapter trimming. Resulting fastq files were then used as input for kallisto quant (version 0.45.0) \u2013 a pseudoalignment based method to quantify RNA abundance at transcript-level in transcripts per million (TPM) counts format. We then used sleuth R package (version 0.30.0) (Pimentel et al., 2017) to output model-based, gene-level normalized TPM matrix which was also corrected for potential batch effects due to RNA-seq data derived from two sequencing core facilities and tissue archival (snap-frozen vs FFPE). Detailed workflow, including command-line parameters for model fitting are in extended methods section. RRBS alignments \u00b6 Raw fastq files from RRBS assay for 45 tumor samples were processed through FastQC (version 0.11.7, https://www.bioinformatics.babraham.ac.uk/projects/fastqc ) and Trim Galore (version 0.5.0, https://github.com/FelixKrueger/TrimGalore ) for quality control, filtering low quality base calls, and adapter trimming. Trimmed reads were then mapped to a bisulfite converted reference genome (canFam3.1, obtained from Ensembl release 85) using the Bismark Bisulfite Mapper (v0.19.1) with the Bowtie2 short read aligner (v2.2.3) (Krueger and Andrews, 2011), allowing for one non-bisulfite mismatch per read. Cytosine methylation calls were made for the mapped reads using the Bismark methylation extractor (version 0.19). The resulting methylation values were obtained as \\(\\beta\\) -values, calculated as the ratio of methylated to total reads at a given CpG site. DNA fingerprinting \u00b6 DNA fingerprinting for each of WGS and exome tumor-normal and tumor-only bam files was done using NGSCheckMate tool (version 1.0.0) (Lee et al., 2017). Germline snps in protein-coding regions was used as a variant reference panel to allow simultaneous fingerprinting of WGS and exome libraries. NGSCheckMate does sample pairing QC based on shared germline variants found in samples (tumor and normal tissue from the same patient) and also model difference between samples (or libraries) based on sequencing depth-dependent variation in allelic fraction of reference variants. Fingerprint results for WGS and exome samples from 77 canine glioma did not show mixture of tumor-normal or cross-patient sample contamination (See Figure S1F).","title":"Alignments"},{"location":"methods/S04_alignments_fprint/#dna-alignments","text":"DNA alignments for whole genome (WGS) and exome sequencing was done using bwa-mem (version 0.7.15-r1140) (Fleshner and Chernett, 1997) with -M -t 12 argument and against CanFam3.1 reference genome from UCSC, https://genome.ucsc.edu/cgi-bin/hgGateway?db=canFam3 (md5: 112bc809596d22c896d7e9bcbe68ede6). For each sample, fastq files were aligned per read group and then merged using Picard tools (v2.18.0, http://broadinstitute.github.io/picard ) SortSam command to make an interim bam file. Final, analysis-ready bam file per sample \u2013 tumor and normal bam, if available \u2013 was created by series of steps following best practices guidelines from GATK4 (version 4.0.8.1) (DePristo et al., 2011), namely MarkDuplicates, Indel Realignment, and Base Quality Score Recalibration (BQSR). Alignment QC metrics were calculated using GATK4 DepthOfCoverage (for WGS) and CollectHSMetrics (for exome) as well as Qualimap (version 2.2.1) (Okonechnikov et al., 2016) bamqc for merged bam files. Coverage statistics were also based on regions of interest (ROIs) which consisted of exonic region-level annotations for biotypes: protein-coding gene, microrna, lincrna, and pseudogene from Ensembl gene annotations for canine genome (v91 and higher). We flagged samples as failed QC if merged bam file has a genome-wide coverage of < 30% or > 75% of ROIs have 30% or lesser coverage. Accordingly, three samples (of three cases) failed QC step and they were removed from all analyses. Note that 77 cases in patient tissues and samples section represent all cases which passed QC at WGS, exome, RNA-seq, and methylation level data preprocessing.","title":"DNA alignments"},{"location":"methods/S04_alignments_fprint/#rna-alignments","text":"Raw fastq files from paired-end RNA-seq assay for 41 tumor samples and 3 matched normal tissue samples were first preprocessed through fastp (version 0.19.5) (Chen et al., 2018) to perform read-based quality pruning, including adapter trimming. Resulting fastq files were then used as input for kallisto quant (version 0.45.0) \u2013 a pseudoalignment based method to quantify RNA abundance at transcript-level in transcripts per million (TPM) counts format. We then used sleuth R package (version 0.30.0) (Pimentel et al., 2017) to output model-based, gene-level normalized TPM matrix which was also corrected for potential batch effects due to RNA-seq data derived from two sequencing core facilities and tissue archival (snap-frozen vs FFPE). Detailed workflow, including command-line parameters for model fitting are in extended methods section.","title":"RNA alignments"},{"location":"methods/S04_alignments_fprint/#rrbs-alignments","text":"Raw fastq files from RRBS assay for 45 tumor samples were processed through FastQC (version 0.11.7, https://www.bioinformatics.babraham.ac.uk/projects/fastqc ) and Trim Galore (version 0.5.0, https://github.com/FelixKrueger/TrimGalore ) for quality control, filtering low quality base calls, and adapter trimming. Trimmed reads were then mapped to a bisulfite converted reference genome (canFam3.1, obtained from Ensembl release 85) using the Bismark Bisulfite Mapper (v0.19.1) with the Bowtie2 short read aligner (v2.2.3) (Krueger and Andrews, 2011), allowing for one non-bisulfite mismatch per read. Cytosine methylation calls were made for the mapped reads using the Bismark methylation extractor (version 0.19). The resulting methylation values were obtained as \\(\\beta\\) -values, calculated as the ratio of methylated to total reads at a given CpG site.","title":"RRBS alignments"},{"location":"methods/S04_alignments_fprint/#dna-fingerprinting","text":"DNA fingerprinting for each of WGS and exome tumor-normal and tumor-only bam files was done using NGSCheckMate tool (version 1.0.0) (Lee et al., 2017). Germline snps in protein-coding regions was used as a variant reference panel to allow simultaneous fingerprinting of WGS and exome libraries. NGSCheckMate does sample pairing QC based on shared germline variants found in samples (tumor and normal tissue from the same patient) and also model difference between samples (or libraries) based on sequencing depth-dependent variation in allelic fraction of reference variants. Fingerprint results for WGS and exome samples from 77 canine glioma did not show mixture of tumor-normal or cross-patient sample contamination (See Figure S1F).","title":"DNA fingerprinting"},{"location":"methods/S05_somatic_variants/","text":"Somatic callers \u00b6 Somatic variant calls were called on the merged whole genome and exome bam files using three callers: GATK4 (version 4.0.8.1) (McKenna et al., 2010) Mutect2 (Cibulskis et al., 2013), VarScan2 (version 2.4.2), and LoFreq (version 2.1.3.1) (Wilm et al., 2012). Matching and fingerprint validated WGS and exome files per sample were merged using Picard tools (v2.18.0, http://broadinstitute.github.io/picard ), MergeSamFiles command. Three somatic callers were then run in either paired tumor \u2013 matched normal (n=57) or tumor-only (n=20) mode. Mutect2 \u00b6 Mutect2 was first run in panel-of-normals (PON) mode using 57 matched normal samples. Resulting PON file was used for calling somatic variant calls using Mutect2 in both, paired and tumor-only mode along with options: 1 --germline-resources 58indiv.unifiedgenotyper.recalibrated_95.5_filtered.pass_snp.fill_tags.vcf.gz \u2013af-of-alleles-not-in-resource 0 .008621 Tumor-only Mutect2 mode was run using default arguments and paired Mutect2 calls had following arguments: 1 --initial-tumor-lod 2 .0 --normal-lod 2 .2 --tumor-lod-to-emit 3 .0 --pcr-indel-model CONSERVATIVE Throughout the process of using GATK4 based tools, including Mutect2, we followed best practices guidelines (DePristo et al., 2011) where practical for canine genome, e.g., in contrast to human genome, population level resources are limited for canine genome. VarScan2 \u00b6 VarScan2 paired mode was run with a command: somatic and arguments: 1 --min-coverage 8 --min-coverage-normal 6 --min-coverage-tumor 8 --min-reads2 2 --min-avg-qual 15 --min-var-freq 0 .08 --min-freq-for-hom 0 .75 --tumor-purity 1 .0 --strand-filter 1 --somatic-p-value 0 .05 --output-vcf 1 VarScan2 tumor-only mode was run using command: 1 mpileup2cns and arguments: --min-coverage 8 --min-reads2 2 --min-avg-qual 15 --min-var-freq 0 .08 --min-freq-for-hom 0 .75 --strand-filter 1 --p-value 0 .05 --variants --output-vcf 1 LoFreq \u00b6 LoFreq paired mode was run using command: 1 somatic and arguments: --threads 4 --call-indels --min-cov 7 \u2013verbose and tumor-only mode was run using command: call and arguments: 1 --call-indels --sig 0 .05 --min-cov 7 --verbose -s Filtering \u00b6 Resulting raw somatic calls - single nucleotide variants (SNV) and small insertions and/or deletions (Indels) - from three callers were then subject to filtering based on caller-specific filters and hard filters. Briefly, Mutect2 calls were subject to extensive filtering based on germline risk, artifacts arising due to sequencing platforms, tissue archival (FFPE), repeat regions, etc. See extended methods and https://software.broadinstitute.org/gatk/documentation/article?id=11136 ). VarScan2 somatic filters were applied as per developer\u2019s guidelines (Koboldt et al., 2013). Hard filters were based upon filtering out variants present in dbSNP and PONs created via GATK4 Mutect2. Filtered somatic calls from three callers (in VCF version 4.2 format) were then subject to consensus somatic calls using SomaticSeq (version 3.1.0) (Fang et al., 2015) in majority voting mode with priority given to Mutect2 filtered (PASS) calls followed by consensus voting based on calls present in VarScan2 and LoFreq filtered calls. Resulting consensus VCF file for 77 cases were finally converted to Variant Effect Predictor (VEP version 91) (McLaren et al., 2016) annotated vcfs and Mutation Annotation Format (MAF, https://docs.gdc.cancer.gov/Data/File_Formats/MAF_Format ) using vcf2maf utility ( https://github.com/mskcc/vcf2maf ). Annotated VCFs and MAFs were used for all of downstream analyses.","title":"Somatic SNVs and Indels"},{"location":"methods/S05_somatic_variants/#somatic-callers","text":"Somatic variant calls were called on the merged whole genome and exome bam files using three callers: GATK4 (version 4.0.8.1) (McKenna et al., 2010) Mutect2 (Cibulskis et al., 2013), VarScan2 (version 2.4.2), and LoFreq (version 2.1.3.1) (Wilm et al., 2012). Matching and fingerprint validated WGS and exome files per sample were merged using Picard tools (v2.18.0, http://broadinstitute.github.io/picard ), MergeSamFiles command. Three somatic callers were then run in either paired tumor \u2013 matched normal (n=57) or tumor-only (n=20) mode.","title":"Somatic callers"},{"location":"methods/S05_somatic_variants/#mutect2","text":"Mutect2 was first run in panel-of-normals (PON) mode using 57 matched normal samples. Resulting PON file was used for calling somatic variant calls using Mutect2 in both, paired and tumor-only mode along with options: 1 --germline-resources 58indiv.unifiedgenotyper.recalibrated_95.5_filtered.pass_snp.fill_tags.vcf.gz \u2013af-of-alleles-not-in-resource 0 .008621 Tumor-only Mutect2 mode was run using default arguments and paired Mutect2 calls had following arguments: 1 --initial-tumor-lod 2 .0 --normal-lod 2 .2 --tumor-lod-to-emit 3 .0 --pcr-indel-model CONSERVATIVE Throughout the process of using GATK4 based tools, including Mutect2, we followed best practices guidelines (DePristo et al., 2011) where practical for canine genome, e.g., in contrast to human genome, population level resources are limited for canine genome.","title":"Mutect2"},{"location":"methods/S05_somatic_variants/#varscan2","text":"VarScan2 paired mode was run with a command: somatic and arguments: 1 --min-coverage 8 --min-coverage-normal 6 --min-coverage-tumor 8 --min-reads2 2 --min-avg-qual 15 --min-var-freq 0 .08 --min-freq-for-hom 0 .75 --tumor-purity 1 .0 --strand-filter 1 --somatic-p-value 0 .05 --output-vcf 1 VarScan2 tumor-only mode was run using command: 1 mpileup2cns and arguments: --min-coverage 8 --min-reads2 2 --min-avg-qual 15 --min-var-freq 0 .08 --min-freq-for-hom 0 .75 --strand-filter 1 --p-value 0 .05 --variants --output-vcf 1","title":"VarScan2"},{"location":"methods/S05_somatic_variants/#lofreq","text":"LoFreq paired mode was run using command: 1 somatic and arguments: --threads 4 --call-indels --min-cov 7 \u2013verbose and tumor-only mode was run using command: call and arguments: 1 --call-indels --sig 0 .05 --min-cov 7 --verbose -s","title":"LoFreq"},{"location":"methods/S05_somatic_variants/#filtering","text":"Resulting raw somatic calls - single nucleotide variants (SNV) and small insertions and/or deletions (Indels) - from three callers were then subject to filtering based on caller-specific filters and hard filters. Briefly, Mutect2 calls were subject to extensive filtering based on germline risk, artifacts arising due to sequencing platforms, tissue archival (FFPE), repeat regions, etc. See extended methods and https://software.broadinstitute.org/gatk/documentation/article?id=11136 ). VarScan2 somatic filters were applied as per developer\u2019s guidelines (Koboldt et al., 2013). Hard filters were based upon filtering out variants present in dbSNP and PONs created via GATK4 Mutect2. Filtered somatic calls from three callers (in VCF version 4.2 format) were then subject to consensus somatic calls using SomaticSeq (version 3.1.0) (Fang et al., 2015) in majority voting mode with priority given to Mutect2 filtered (PASS) calls followed by consensus voting based on calls present in VarScan2 and LoFreq filtered calls. Resulting consensus VCF file for 77 cases were finally converted to Variant Effect Predictor (VEP version 91) (McLaren et al., 2016) annotated vcfs and Mutation Annotation Format (MAF, https://docs.gdc.cancer.gov/Data/File_Formats/MAF_Format ) using vcf2maf utility ( https://github.com/mskcc/vcf2maf ). Annotated VCFs and MAFs were used for all of downstream analyses.","title":"Filtering"},{"location":"methods/S06_smgs/","text":"SMG analysis in canine gliomas (Figure 1A, 1C, 2A) with paired tumor-normal samples (n=57) was performed using dNdS (Martincorena et al., 2017) and MuSiC2 (version 0.2) (Dees et al., 2012). We excluded tumor-only cases for being conservative in SMG analysis and minimize false-positives. Also, MuSiC2 required matched normal tissue required matched normal tissue for SMG analysis. Detailed parameters for SMG analysis are in extended methods. Detailed output from both methods in respectively in table S2 and table S3.","title":"Significantly Mutated Genes"},{"location":"methods/S07_hallmarks/","text":"Cancer hallmarks were defined according to published ten hallmarks (Hanahan and Weinberg, 2011) and one additional hallmark, i.e. epigenetic (Imielinski et al., 2012). A pool of 268 known glioma (Ceccarelli et al., 2016; Mackay et al., 2017) and pan-cancer driver genes (Gr\u00f6bner et al., 2018; Bailey et al. 2018) were mapped to hallmarks following a previously published computer-assisted manual curation method (Table S4) (Iorio et al., 2018). Based on WHO molecular classification of brain tumors, somatic SNV and copy-number data from patients with human adult gliomas (AG) (Ceccarelli et al., 2016) were stratified into IDHwt (n=373), IDHmut-codel (n=169) and IDHmut-noncodel (n=268) subgroups while corresponding data from patients with human pediatric glioma (PG) (Mackay et al., 2017) were subgrouped based on mutations in Histone H3 gene, namely H3mut (n=200) and H3wt (n=126). For canine patients with glioma (CG), we used somatic mutations and copy-number calls from 67 cases with paired tumor-normal samples. For each of the six cohorts coding mutations were mapped to eleven hallmarks and coverage adjusted relative proportions of patients harboring an alteration in a given hallmark were calculated. For comparisons between cohorts a two-sided Fisher\u2019s exact test was applied (Table S5).","title":"Cancer Hallmarks"},{"location":"methods/S09_mutation_rate/","text":"Somatic mutations (SNVs and Indels) rate was estimated within coding genes and adjusted based on relative per-base coverage with minimum coverage of 30X in coding regions (Figure 1D). Coding mutation rates for human pediatric (n=961) and adult cancers (n=3,800, includes 811 adult gliomas) were taken from published studies (Ceccarelli et al., 2016; Gr\u00f6bner et al., 2018; Ma et al., 2018).","title":"Somatic Mutation Rate"},{"location":"methods/S10_SCNA/","text":"Segmentation and Significant Peaks \u00b6 Somatic copy-numbers were called for paired tumor-normal cases (n=56) using HMMCopy tool (version 1.22.0) using author\u2019s recommendations. In brief, GC counts and mappability files for CanFam3.1 genome were generated with 1000 bp window size. Read counts for each of tumor and normal bam files were generated using 1000 bp window size. Resulting count, mappability and count files were feed into HMMCopy algorithm ( http://bioconductor.org/packages/release/bioc/html/HMMcopy.html ) and segmentations were called using Viterbi algorithm. Segmented copy number calls were used to generate Integrated Genome Viewer (IGV) copy-number plots and GISTIC2 (version 2.0.22) based somatic copy number significance (Mermel et al., 2011), including calling gene-level deep deletions, loss-of-heterozygosity (LOH), and amplifications (Figure 2A) as well as inferring aneuploidy metrics (Figure 2B, 2C, 2D). Segmented copy number for pediatric gliomas (n=53) were called by using cloud-based TitanCNA workflow ( https://dxapp.verhaaklab.com/dnanexus_ngsapp ). Segmented copy number for adult gliomas were derived from SNP6 based platform from the TCGA Broad Firehose platform (version stddata__2016_01_28) with following download urls: 1 2 3 http://gdac.broadinstitute.org/runs/stddata__2016_01_28/data/GBM/20160128/gdac.broadinstitute.org_GBM.Merge_snp__genome_wide_snp_6__broad_mit_edu__Level_3__segmented_scna_minus_germline_cnv_hg19__seg.Level_3.2016012800.0.0.tar.gz http://gdac.broadinstitute.org/runs/stddata__2016_01_28/data/LGG/20160128/gdac.broadinstitute.org_LGG.Merge_snp__genome_wide_snp_6__broad_mit_edu__Level_3__segmented_scna_minus_germline_cnv_hg19__seg.Level_3.2016012800.0.0.tar.gz Only primary tumor cases from TCGA GBM (n=577) and TCGA LGG (n=513) cohort were used for downstream analyses, i.e., pathway analysis (Figure 1C) and aneuploidy metrics (Figure 2B, 2C, 2D). Allele-specific SCNA \u00b6 We derived allele-specific copy numbers and copy-number based clonality inference (including purity and ploidy estimates) using TitanCNA algorithm (version 1.19.1) (Ha et al., 2014). Snakemake (version 5.2.1) based workflow(Koster and Rahmann, 2018) was implemented using default arguments and genome-specific germline dbSNP resource (see under extended methods) ( https://github.com/gavinha/TitanCNA/tree/master/scripts/snakemake ) for WGS paired tumor-normal samples from 56 canine patients. For pediatric gliomas (n=53) and adult gbms with WGS data (n=23), allele-specific copy-number calls were used from TitanCNA workflow. Allele-specific copy-numbers were used for mutational signature and molecular timing analysis (Figure 3).","title":"Somatic Copy Number Aberrations"},{"location":"methods/S10_SCNA/#segmentation-and-significant-peaks","text":"Somatic copy-numbers were called for paired tumor-normal cases (n=56) using HMMCopy tool (version 1.22.0) using author\u2019s recommendations. In brief, GC counts and mappability files for CanFam3.1 genome were generated with 1000 bp window size. Read counts for each of tumor and normal bam files were generated using 1000 bp window size. Resulting count, mappability and count files were feed into HMMCopy algorithm ( http://bioconductor.org/packages/release/bioc/html/HMMcopy.html ) and segmentations were called using Viterbi algorithm. Segmented copy number calls were used to generate Integrated Genome Viewer (IGV) copy-number plots and GISTIC2 (version 2.0.22) based somatic copy number significance (Mermel et al., 2011), including calling gene-level deep deletions, loss-of-heterozygosity (LOH), and amplifications (Figure 2A) as well as inferring aneuploidy metrics (Figure 2B, 2C, 2D). Segmented copy number for pediatric gliomas (n=53) were called by using cloud-based TitanCNA workflow ( https://dxapp.verhaaklab.com/dnanexus_ngsapp ). Segmented copy number for adult gliomas were derived from SNP6 based platform from the TCGA Broad Firehose platform (version stddata__2016_01_28) with following download urls: 1 2 3 http://gdac.broadinstitute.org/runs/stddata__2016_01_28/data/GBM/20160128/gdac.broadinstitute.org_GBM.Merge_snp__genome_wide_snp_6__broad_mit_edu__Level_3__segmented_scna_minus_germline_cnv_hg19__seg.Level_3.2016012800.0.0.tar.gz http://gdac.broadinstitute.org/runs/stddata__2016_01_28/data/LGG/20160128/gdac.broadinstitute.org_LGG.Merge_snp__genome_wide_snp_6__broad_mit_edu__Level_3__segmented_scna_minus_germline_cnv_hg19__seg.Level_3.2016012800.0.0.tar.gz Only primary tumor cases from TCGA GBM (n=577) and TCGA LGG (n=513) cohort were used for downstream analyses, i.e., pathway analysis (Figure 1C) and aneuploidy metrics (Figure 2B, 2C, 2D).","title":"Segmentation and Significant Peaks"},{"location":"methods/S10_SCNA/#allele-specific-scna","text":"We derived allele-specific copy numbers and copy-number based clonality inference (including purity and ploidy estimates) using TitanCNA algorithm (version 1.19.1) (Ha et al., 2014). Snakemake (version 5.2.1) based workflow(Koster and Rahmann, 2018) was implemented using default arguments and genome-specific germline dbSNP resource (see under extended methods) ( https://github.com/gavinha/TitanCNA/tree/master/scripts/snakemake ) for WGS paired tumor-normal samples from 56 canine patients. For pediatric gliomas (n=53) and adult gbms with WGS data (n=23), allele-specific copy-number calls were used from TitanCNA workflow. Allele-specific copy-numbers were used for mutational signature and molecular timing analysis (Figure 3).","title":"Allele-specific SCNA"},{"location":"methods/S11_aneuploidy/","text":"The simplest metric of aneuploidy was computed by taking the size of all non-neutral segments divided by the size of all segments. The resulting aneuploidy value indicates the proportion of the segmented genome that is non-diploid. In parallel, an arm-level aneuploidy score modeled after a previously described method was computed (Taylor et al., 2018). Briefly, adjacent segments with identical arm-level calls (-1, 0 or 1) were merged into a single segment with a single call. For each merged/reduced segment, the proportion of the chromosome arm it spans was calculated. Segments spanning greater than 80% of the arm length resulted in a call of either -1 (loss), 0 (neutral) or +1 (gain) to the entire arm, or NA if no contiguous segment spanned at least 80% of the arm's length. For each sample the number of arms with a non-neutral event was finally counted. The resulting aneuploidy score is a positive integer with a minimum value of 0 (no chromosomal arm-level events detected) and a maximum value of 38 (total number of autosomal chromosome arms \u2013 given all of canine chromosomes are either acrocentric or telocentric). Clustering based on shared syntenic regions \u00b6 Shared syntenic regions between CanFam3.1 and hg19 reference genome were downloaded from Ensembl BioMart (version 94) database using orthologous mapped Ensembl gene ids. Arm-level synteny was based on arm-level aneuploidy scores of shared syntenic regions in the respective, canine and human genomes. Hierarchical clustering of proportion of patients per molecular subtype having syntenic arm-level aneuploidy was then carried out for each of canine, human pediatric and adult cohort (Figure 2C).","title":"Aneuploidy Metrics"},{"location":"methods/S11_aneuploidy/#clustering-based-on-shared-syntenic-regions","text":"Shared syntenic regions between CanFam3.1 and hg19 reference genome were downloaded from Ensembl BioMart (version 94) database using orthologous mapped Ensembl gene ids. Arm-level synteny was based on arm-level aneuploidy scores of shared syntenic regions in the respective, canine and human genomes. Hierarchical clustering of proportion of patients per molecular subtype having syntenic arm-level aneuploidy was then carried out for each of canine, human pediatric and adult cohort (Figure 2C).","title":"Clustering based on shared syntenic regions"},{"location":"methods/S12_ith/","text":"We estimated patient-level ITH based on whole-genome derived subclonal structure and number of somatic variants in each of these subclones. Subclonal structure and cellular prevalence or cancer cell fraction of each tumor subclone (and underlying somatic variants) was derived using TITAN allele-specific copy number calls. Since accuracy of inferred subclonal structure depends largely on sequencing read depth and number of somatic variants per inferred subclone, we limited estimation of subclonal structure for maximum five subclones per patient given a minimum sequencing read depth of 30X for whole genome data we had across all three cohorts. Shannon entropy was then calculated using entropy function in the R package: entropy by taking number of somatic variants per subclone per patient as a vector. A resulting Shannon entropy value was used to plot figures along with cancer cell fraction and number of clones derived per patient. We acknowledge that our estimation of ITH and resolving subclonal structure can be improved with higher depth of sequencing (100X or more) to detect subclonal structures (number of clones) (Deshwar et al., 2015).","title":"Intratumor Heterogeneity"},{"location":"methods/S13_mut_sigs/","text":"Mutational signature analysis was performed in two-parts. De-novo signatures \u00b6 First, de-novo signatures (Figure 3B) were constructed for canine (n=77), human pediatric (n=53) and adult cohort (n=23) using somatic snvs from whole-genome data. Signatures were constructed using non-negative matrix factorization (nmf R package, version 0.21.0) with brunet approach and 100 iterations with expected range of signatures between 2 to 10. Optimal signatures were then selected using nmfEstimateRank function to match number of de-novo signatures (clusters) \u2013 1 where inflection point for cophenetic correlation coefficient was observed. Accordingly, three de-novo signatures were found in canine and human pediatric gliomas while five in adult glioblastoma cohort. Known human signatures \u00b6 In the second part, known human mutational signatures from COSMIC (v2, n=30) and published pediatric cancer signature from two studies, T1 to T11 (Mansour et al., 2018) and P1 (Gr\u00f6bner et al., 2018) were pooled together and used to deconvolute (MutationalPattern R package, version 1.6.2) mutational trinucleotide context (n=96) from somatic snvs in each of three cohorts. Somatic ultra-hypermutation cases from pediatric (n=3) and adult cohort (n=1) were excluded from signature analysis. Cosine similarities of known signatures with de-novo signatures was then calculated and clustered using hierarchical clustering (Figure 3B). Absolute and relative contribution of known signatures per sample was then quantified using fit_to_signatures function which finds the linear combination of signatures that closely resembles 96 context based mutational matrix by solving the nonnegative least-squares constraints problem. We then selected top contributing signatures per cohort based on signatures which contributed per sample to higher than 3 rd quartile of median value of each signature\u2019s contribution (rowMedian) per cohort (Figure S3A). Top contributing signatures were further calculated using outlier profling on canine patients showing highest mutational load (>3 rd quartile of median coding mutation rate per megabase) and plotted in Figure 3A. Outlier sample detection was done using car::outlierTest function in R to label true outliers from entire cohort (2 cases) while correcting for confounding effects due to type of tissue archival (snap-frozen vs ffpe) and analysis type (tumor-matched normal versus tumor-only somatic variant calling). This was followed by second run of outlier by first excluding true outliers (2 cases), and then labelling outliers (six cases) based on chi-squared statistics using outliers::scores function in R. Signatures contributing to driver mutations (Figure 3C) were calculated based on first getting relative proportion of trinucleotide context per snv and then finding known signatures with maximum value for the same trinucleotide context. Known signatures were combined to a single group where they are shown in literature as potential underlying process, e.g., aging group is associated with COSMIC signature 1 and 5, and show significant cosine similarity (> 0.9) with pediatric signatures T1 and T4, respectively. Table S6 provides mapping between signature and known/proposed mechanisms, if any.","title":"Mutational Signatures"},{"location":"methods/S13_mut_sigs/#de-novo-signatures","text":"First, de-novo signatures (Figure 3B) were constructed for canine (n=77), human pediatric (n=53) and adult cohort (n=23) using somatic snvs from whole-genome data. Signatures were constructed using non-negative matrix factorization (nmf R package, version 0.21.0) with brunet approach and 100 iterations with expected range of signatures between 2 to 10. Optimal signatures were then selected using nmfEstimateRank function to match number of de-novo signatures (clusters) \u2013 1 where inflection point for cophenetic correlation coefficient was observed. Accordingly, three de-novo signatures were found in canine and human pediatric gliomas while five in adult glioblastoma cohort.","title":"De-novo signatures"},{"location":"methods/S13_mut_sigs/#known-human-signatures","text":"In the second part, known human mutational signatures from COSMIC (v2, n=30) and published pediatric cancer signature from two studies, T1 to T11 (Mansour et al., 2018) and P1 (Gr\u00f6bner et al., 2018) were pooled together and used to deconvolute (MutationalPattern R package, version 1.6.2) mutational trinucleotide context (n=96) from somatic snvs in each of three cohorts. Somatic ultra-hypermutation cases from pediatric (n=3) and adult cohort (n=1) were excluded from signature analysis. Cosine similarities of known signatures with de-novo signatures was then calculated and clustered using hierarchical clustering (Figure 3B). Absolute and relative contribution of known signatures per sample was then quantified using fit_to_signatures function which finds the linear combination of signatures that closely resembles 96 context based mutational matrix by solving the nonnegative least-squares constraints problem. We then selected top contributing signatures per cohort based on signatures which contributed per sample to higher than 3 rd quartile of median value of each signature\u2019s contribution (rowMedian) per cohort (Figure S3A). Top contributing signatures were further calculated using outlier profling on canine patients showing highest mutational load (>3 rd quartile of median coding mutation rate per megabase) and plotted in Figure 3A. Outlier sample detection was done using car::outlierTest function in R to label true outliers from entire cohort (2 cases) while correcting for confounding effects due to type of tissue archival (snap-frozen vs ffpe) and analysis type (tumor-matched normal versus tumor-only somatic variant calling). This was followed by second run of outlier by first excluding true outliers (2 cases), and then labelling outliers (six cases) based on chi-squared statistics using outliers::scores function in R. Signatures contributing to driver mutations (Figure 3C) were calculated based on first getting relative proportion of trinucleotide context per snv and then finding known signatures with maximum value for the same trinucleotide context. Known signatures were combined to a single group where they are shown in literature as potential underlying process, e.g., aging group is associated with COSMIC signature 1 and 5, and show significant cosine similarity (> 0.9) with pediatric signatures T1 and T4, respectively. Table S6 provides mapping between signature and known/proposed mechanisms, if any.","title":"Known human signatures"},{"location":"methods/S14_mut_timing/","text":"Probabilistic estimation of relative timing of driver mutations (among 73 observed somatic snvs in cancer driver genes) was based on existing methods (Gerstung et al., 2017; Jolly and Van Loo, 2018) with several steps carried out using Palimpsest R package (version 1.0.0; https://github.com/FunGeST/Palimpsest ) (Shinde et al., 2018) and custom R scripts based on published approach(McGranahan et al., 2015): First step involved categorizing somatic drivers into clonal vs subclonal events using estimated cancer cell fraction (CCF) which is estimated fraction of cancer cells with a somatic snv. CCF per somatic snv was a product of variant allelic fraction (VAF) of a somatic snv, adjusted by local copy number of gene locus and whole tumor sample (ploidy) as well as purity estimate (tumor cell content) inferred from TitanCNA algorithm (Detailed under copy number estimation section above). A clonal (early) vs subclonal (late) mutation was then classified based on upper boundary of CCF was above 0.95 (clonal) or not (subclonal). Second, we timed copy number gain and copy-neutral LOH regions based on VAF of somatic snvs in these copy regions, i.e., early mutations prior to copy gain will have higher VAF relative to VAF of late mutations after copy gain. Third, we ordered mutations in four sequential categories: early clonal, early subclonal, late clonal, and late subclonal. We note here that early subclonal and late clonal categories are result of underlying parallel and/or convergent evolution of multiple clones (Venkatesan and Swanton, 2016) and/or a technical limitation (given ~60X depth of merged bam files and lack of spatial sequencing data) in resolving polyclonal structure of a tumor sample (Deshwar et al., 2015). We then tally frequency of each of these four categories per somatic driver mutation and get the average frequency of each category per driver mutation at cohort (canine, pediatric, adult) level. These average frequencies are converted to winning tables, similar to sports statistics where each driver mutation competes with remaining driver mutations with winning being an early somatic event based on order of events using clonality (Jolly and Van Loo, 2018) (step 3). Finally, a winning table is then passed to Bradley-Terry model ( BradleyTerryScalable R package, version 0.1.0.9000; https://cran.r-project.org/web/packages/BradleyTerryScalable/vignettes/BradleyTerryScalable.html ) to estimate winning probability (driver event being an early event) based on a Bayesian maximum a posteriori probability (MAP) estimate. Resulting winning probability per driver mutation is subtracted from 1 to plot multiple density plots (ggridges R package, version: 0.5.1.9000) with X-axis now showing a probability of event being a late event (Figure 3D). We note that density plots are based on kernel density estimates and thus, may extend their tails (probability distribution) beyond 1 or less than zero ( https://serialmentor.com/dataviz/histograms-density-plots.html ).","title":"Molecular Timing of Somatic Drivers"},{"location":"methods/S15_class_predict_methy/","text":"To compare the methylation patterns of human and canine glioma, the LIBLINEAR library was used to fit an L2-regularized logistic regression classifier. Model training and validation was performed on the human glioma samples and normal controls in the GSE109381 dataset (Capper et al., 2018), with the methylation status of CpGs located in regions of the human genome orthologous to canine CpG islands used to predict DNA methylation-based subtypes of glioma. The methylation categories designated as regression outcome variables were derived from the World Health Organization classification of gliomas: IDH-wildtype adult glioma, IDH-mutant, 1p/19q-intact adult glioma, IDH-mutant, 1p/19q-codeleted adult glioma, adult normal control, pediatric glioma, and pediatric normal control. After model fitting, the logistic regression classifier was applied to the canine samples, using the \uf062-values of CpGs orthologous to the selected 11,495 Illumina 450K probes as input data. For classifier CpG sites in the canine samples with no methylation observations, \\(\\beta\\) -values were predicted using the DNA module of the DeepCpG algorithm, a deep learning algorithm that predicts methylation state based on local DNA sequence context (Angermueller et al., 2017). The logistic regression classifier outputs the probability that a sample matches a given methylation category. Category probabilities were calculated for the canine samples, and these probabilities were compared with sample age, anatomical location, tumor grade, tumor purity, and mutation rate (Figure 4).","title":"Class Prediction using methylation classifier"},{"location":"methods/S16_expression_immune/","text":"Immunohistochemistry \u00b6 Hematoxylin & Eosin staining was used to classify glioma grade and lineage. The immunohistochemistry panel included those antibodies that have been documented to work in canine tissues and include myeloid microglia/macrophages (IBA1), monocytes (CD14) and their M2 skew subtype (CD163), and lymphoid T cells (CD3) and B cells (CD79a). Slides with 5um sections, were deparaffinized and rehydrated in a dry incubator (60\u00b0C for 1 hour), xylene, and histological grade ethanol. Antigen retrieval was performed using citrate buffer and a pressure cooker at 120\u00b0C23 for 12 minutes. Quenching for endogenous peroxidase was performed with 3% H2O2 for 15 minutes at room temperature. Non-specific binding was minimized using ready-to-use protein blocker (Dako) applied for 15 minutes before the application of the primary antibody overnight at 4\u00b0C. All the washing was done using 1x T-PBS buffer mixed with 0.1% Tween 20. The biotinylated secondary antibody was applied for 30 minutes at room temperature followed by three washes with buffer for 5 minutes each. Color development was performed using the DAKO DAB kit and color change was monitored until an appropriate detectable level was achieved (10-60 sec depending on the antibody). Slides were counterstained with hematoxylin (25 seconds) and bluing buffer, then rehydrated and cover-slipped with long lasting mounting solution. The immunohistochemistry quantification were done blindly relative to the tumor pathology. Scanning and tissue segmentation \u00b6 Scanning and analysis were performed using the PerkinElmer Vectra Automated Quantitative Pathology Imaging System and the inForm Cell Analysis software (ver 2.4). Slides were scanned twice on low- and high-power fields as follows: the first scan was of the whole slide on low power field (10x) for manual tissue segmentation to identify three tumor regions/categories as necrotic center, tumor and invasive edge under the neuropathologist\u2019s supervision/direction. For each region, every fourth field was imaged (25%) on high-power field (20x) and resulted in 21 to 274 fields per slide, which varies according to the size of the tissue and presence or absence of necrosis. For the training set, heterogeneous fields were randomly selected to include tissue, non-tissue and damaged areas. Hematoxylin and DAB was used to identify the nuclei. Positive and negative cells were distinguished visually and three optical densities (OD) thresholds were set accordingly. The thresholds allowed 4-bin (0 = negative, +1 = weak positive, +2 = intermediate, +3 = strong positive) sorting of cells depending on the positivity and its intensity. The intermediate positivity threshold was calculated as the midpoint after setting the lower and higher threshold. The algorithm of the training set was applied for all the high-power fields captured. The results were inspected and the nonspecific and defective fields were removed before compiling the dataset. The same process was applied for all seven markers. CIBERSORT based expression analysis \u00b6 Processed RNA-seq expression matrices from canine (n=40; 25 HGG, 14 LGG, 1 unknown grade), adult (n=703; 529 LGG, 174 GBM), and pediatric glioma (n=92; 42 LGG, 50 HGG) were each run as separate jobs into the CIBERSORT webserver ( https://cibersort.stanford.edu ) and processed in relative mode using the following parameters: Signature Genes: LM22 CIBERSORT default, Permutations run: 100, Quantile normalization disabled (Newman et al., 2015). The resulting cellular fraction tables were then collapsed from 22 cell types into 11 based on lineage, using groupings from a prior publication (Gentles et al., 2015).","title":"Immune Microenvironment Analysis"},{"location":"methods/S16_expression_immune/#immunohistochemistry","text":"Hematoxylin & Eosin staining was used to classify glioma grade and lineage. The immunohistochemistry panel included those antibodies that have been documented to work in canine tissues and include myeloid microglia/macrophages (IBA1), monocytes (CD14) and their M2 skew subtype (CD163), and lymphoid T cells (CD3) and B cells (CD79a). Slides with 5um sections, were deparaffinized and rehydrated in a dry incubator (60\u00b0C for 1 hour), xylene, and histological grade ethanol. Antigen retrieval was performed using citrate buffer and a pressure cooker at 120\u00b0C23 for 12 minutes. Quenching for endogenous peroxidase was performed with 3% H2O2 for 15 minutes at room temperature. Non-specific binding was minimized using ready-to-use protein blocker (Dako) applied for 15 minutes before the application of the primary antibody overnight at 4\u00b0C. All the washing was done using 1x T-PBS buffer mixed with 0.1% Tween 20. The biotinylated secondary antibody was applied for 30 minutes at room temperature followed by three washes with buffer for 5 minutes each. Color development was performed using the DAKO DAB kit and color change was monitored until an appropriate detectable level was achieved (10-60 sec depending on the antibody). Slides were counterstained with hematoxylin (25 seconds) and bluing buffer, then rehydrated and cover-slipped with long lasting mounting solution. The immunohistochemistry quantification were done blindly relative to the tumor pathology.","title":"Immunohistochemistry"},{"location":"methods/S16_expression_immune/#scanning-and-tissue-segmentation","text":"Scanning and analysis were performed using the PerkinElmer Vectra Automated Quantitative Pathology Imaging System and the inForm Cell Analysis software (ver 2.4). Slides were scanned twice on low- and high-power fields as follows: the first scan was of the whole slide on low power field (10x) for manual tissue segmentation to identify three tumor regions/categories as necrotic center, tumor and invasive edge under the neuropathologist\u2019s supervision/direction. For each region, every fourth field was imaged (25%) on high-power field (20x) and resulted in 21 to 274 fields per slide, which varies according to the size of the tissue and presence or absence of necrosis. For the training set, heterogeneous fields were randomly selected to include tissue, non-tissue and damaged areas. Hematoxylin and DAB was used to identify the nuclei. Positive and negative cells were distinguished visually and three optical densities (OD) thresholds were set accordingly. The thresholds allowed 4-bin (0 = negative, +1 = weak positive, +2 = intermediate, +3 = strong positive) sorting of cells depending on the positivity and its intensity. The intermediate positivity threshold was calculated as the midpoint after setting the lower and higher threshold. The algorithm of the training set was applied for all the high-power fields captured. The results were inspected and the nonspecific and defective fields were removed before compiling the dataset. The same process was applied for all seven markers.","title":"Scanning and tissue segmentation"},{"location":"methods/S16_expression_immune/#cibersort-based-expression-analysis","text":"Processed RNA-seq expression matrices from canine (n=40; 25 HGG, 14 LGG, 1 unknown grade), adult (n=703; 529 LGG, 174 GBM), and pediatric glioma (n=92; 42 LGG, 50 HGG) were each run as separate jobs into the CIBERSORT webserver ( https://cibersort.stanford.edu ) and processed in relative mode using the following parameters: Signature Genes: LM22 CIBERSORT default, Permutations run: 100, Quantile normalization disabled (Newman et al., 2015). The resulting cellular fraction tables were then collapsed from 22 cell types into 11 based on lineage, using groupings from a prior publication (Gentles et al., 2015).","title":"CIBERSORT based expression analysis"}]}