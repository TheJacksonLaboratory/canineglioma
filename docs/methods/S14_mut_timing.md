---
title: Molecular Timing of Somatic Drivers
---

Probabilistic estimation of relative timing of driver mutations (among 73 observed somatic snvs in cancer driver genes) was based on existing methods (Gerstung et al., 2017; Jolly and Van Loo, 2018) with several steps carried out using Palimpsest R package (version 1.0.0; https://github.com/FunGeST/Palimpsest) (Shinde et al., 2018) and custom R scripts based on published approach(McGranahan et al., 2015):

First step involved categorizing somatic drivers into clonal vs subclonal events using estimated cancer cell fraction (CCF) which is estimated fraction of cancer cells with a somatic snv. CCF per somatic snv was a product of variant allelic fraction (VAF) of a somatic snv, adjusted by local copy number of gene locus and whole tumor sample (ploidy) as well as purity estimate (tumor cell content) inferred from TitanCNA algorithm (Detailed under copy number estimation section above). A clonal (early) vs subclonal (late) mutation was then classified based on upper boundary of CCF was above 0.95 (clonal) or not (subclonal).

Second, we timed copy number gain and copy-neutral LOH regions based on VAF of somatic snvs in these copy regions, i.e., early mutations prior to copy gain will have higher VAF relative to VAF of late mutations after copy gain.

Third, we ordered mutations in four sequential categories: early clonal, early subclonal, late clonal, and late subclonal. We note here that early subclonal and late clonal categories are result of underlying parallel and/or convergent evolution of multiple clones (Venkatesan and Swanton, 2016) and/or a technical limitation (given ~60X depth of merged bam files and lack of spatial sequencing data) in resolving polyclonal structure of a tumor sample (Deshwar et al., 2015).

We then tally frequency of each of these four categories per somatic driver mutation and get the average frequency of each category per driver mutation at cohort (canine, pediatric, adult) level. These average frequencies are converted to winning tables, similar to sports statistics where each driver mutation competes with remaining driver mutations with winning being an early somatic event based on order of events using clonality (Jolly and Van Loo, 2018) (step 3). Finally, a winning table is then passed to Bradley-Terry model (*BradleyTerryScalable* R package, version 0.1.0.9000; https://cran.r-project.org/web/packages/BradleyTerryScalable/vignettes/BradleyTerryScalable.html) to estimate winning probability (driver event being an early event) based on a Bayesian maximum a posteriori probability (MAP) estimate. Resulting winning probability per driver mutation is subtracted from 1 to plot multiple density plots (ggridges R package, version: 0.5.1.9000) with X-axis now showing a probability of event being a late event (Figure 3D). We note that density plots are based on kernel density estimates and thus, may extend their tails (probability distribution) beyond 1 or less than zero (https://serialmentor.com/dataviz/histograms-density-plots.html).
