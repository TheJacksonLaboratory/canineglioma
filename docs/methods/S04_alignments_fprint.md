---
title: Sequencing alignments, QC, and Fingerprinting
---

## DNA alignments

DNA alignments for whole genome (WGS) and exome sequencing was done using bwa-mem (version 0.7.15-r1140) (Fleshner and Chernett, 1997) with `-M -t 12` argument and against CanFam3.1 reference genome from UCSC, https://genome.ucsc.edu/cgi-bin/hgGateway?db=canFam3 (md5: 112bc809596d22c896d7e9bcbe68ede6). For each sample, fastq files were aligned per read group and then merged using Picard tools (v2.18.0, http://broadinstitute.github.io/picard) SortSam command to make an interim bam file. Final, analysis-ready bam file per sample – tumor and normal bam, if available – was created by series of steps following best practices guidelines from GATK4 (version 4.0.8.1) (DePristo et al., 2011), namely MarkDuplicates, Indel Realignment, and Base Quality Score Recalibration (BQSR). Alignment QC metrics were calculated using GATK4 DepthOfCoverage (for WGS) and CollectHSMetrics (for exome) as well as Qualimap (version 2.2.1) (Okonechnikov et al., 2016) bamqc for merged bam files. Coverage statistics were also based on regions of interest (ROIs) which consisted of exonic region-level annotations for biotypes: protein-coding gene, microrna, lincrna, and pseudogene from Ensembl gene annotations for canine genome (v91 and higher). We flagged samples as failed QC if merged bam file has a genome-wide coverage of < 30% or > 75% of ROIs have 30% or lesser coverage. Accordingly, three samples (of three cases) failed QC step and they were removed from all analyses. Note that 77 cases in patient tissues and samples section represent all cases which passed QC at WGS, exome, RNA-seq, and methylation level data preprocessing.

## RNA alignments

Raw fastq files from paired-end RNA-seq assay for 41 tumor samples and 3 matched normal tissue samples were first preprocessed through fastp (version 0.19.5) (Chen et al., 2018) to perform read-based quality pruning, including adapter trimming. Resulting fastq files were then used as input for kallisto quant (version 0.45.0) – a pseudoalignment based method to quantify RNA abundance at transcript-level in transcripts per million (TPM) counts format. We then used sleuth R package (version 0.30.0) (Pimentel et al., 2017) to output model-based, gene-level normalized TPM matrix which was also corrected for potential batch effects due to RNA-seq data derived from two sequencing core facilities and tissue archival (snap-frozen vs FFPE). Detailed workflow, including command-line parameters for model fitting are in extended methods section.

## RRBS alignments

Raw fastq files from RRBS assay for 45 tumor samples were processed through FastQC (version 0.11.7, https://www.bioinformatics.babraham.ac.uk/projects/fastqc) and Trim Galore (version 0.5.0,  https://github.com/FelixKrueger/TrimGalore) for quality control, filtering low quality base calls, and adapter trimming. Trimmed reads were then mapped to a bisulfite converted reference genome (canFam3.1, obtained from Ensembl release 85) using the Bismark Bisulfite Mapper (v0.19.1) with the Bowtie2 short read aligner (v2.2.3) (Krueger and Andrews, 2011), allowing for one non-bisulfite mismatch per read. Cytosine methylation calls were made for the mapped reads using the Bismark methylation extractor (version 0.19). The resulting methylation values were obtained as $\beta$-values, calculated as the ratio of methylated to total reads at a given CpG site.

## DNA fingerprinting

DNA fingerprinting for each of WGS and exome tumor-normal and tumor-only bam files was done using NGSCheckMate tool (version 1.0.0) (Lee et al., 2017). Germline snps in protein-coding regions was used as a variant reference panel to allow simultaneous fingerprinting of WGS and exome libraries. NGSCheckMate does sample pairing QC based on shared germline variants found in samples (tumor and normal tissue from the same patient) and also model difference between samples (or libraries) based on sequencing depth-dependent variation in allelic fraction of reference variants. Fingerprint results for WGS and exome samples from 77 canine glioma did not show mixture of tumor-normal or cross-patient sample contamination (See Figure S1F). 
